//--------------------Sonic CD HUD Script---------------------//
//--------Scripted by Christian Whitehead 'The Taxman'--------//
//-------Unpacked By Rubberduckycooly's Script Unpacker-------//

// Aliases
// Not all of these are used here in the HUD script, some are just used as a way for other objects to globally transmit values


// Game Mode Aliases
private alias 2 : MODE_TIMEATTACK

// Priority
private alias 1 : PRIORITY_ACTIVE

public value UseFlashlight = 0;
public value MouseEnabled = 0;
public value FlashBattery = 5000;

public alias saveRAM[295]: saved.mobile
public alias saveRAM[296]: saved.transmobile

private alias Object.Value0 : Object.Timer 
private alias Object.Value1 : Logo.Xpos


private alias object.value6 : object.extraoffset
private alias object.value7 : object.extratarget

private alias 5 : ST.xspeed



reserve function TouchControls

function TouchControls
	object.inkEffect = INK_ALPHA

	temp0 = screen.xsize
	temp0 -= 44
	DrawSpriteScreenXY(49,  26,1 49) //dpad
	temp0 -= 39

	DrawSpriteScreenXY(56, 0, temp0, 8) //pause

	//movement
	
	temp0 -= 10
	if inputDown.Left==1
		DrawSpriteScreenXY(52,  26, 151)
	endif
	if inputDown.Down==1
		DrawSpriteScreenXY(51,  26, 189)
	end if
	if inputDown.Right==1
		DrawSpriteScreenXY(53,  64, 151)
	endif
	if inputDown.Up==1
		DrawSpriteScreenXY(50,  26, 151)
	endif
	
	temp0 += 15	
	//jump
	if inputDown.buttonA==1
		DrawSpriteScreenXY(55,  temp0, 163)	
	else
		DrawSpriteScreenXY(54,  temp0, 163)
	endif

	temp0 -= 50
	//flashlight
	if inputDown.buttonY==1
		DrawSpriteScreenXY(58,  temp0, 54)	
	else
		DrawSpriteScreenXY(57,  temp0, 54)
	endif	

	temp0 += 80
	DrawSpriteScreenXY(59,  temp0, 6)


end function

event ObjectMain
	switch object.state
	case 0	//setup
		object.timer = 255
		Logo.Xpos = screen.xcenter
			
		object.state++
	//	PlayMusic(0)	
	break
	case 1	//fade in
		if object.timer > -1
			object.timer -= 4
		else
			object.timer = 0	
		end if
		SetClassicFade(0, 0, 0, Object.Timer)
		if object.timer == 0
			object.state++
		end if
	break
	case 2	//logo move in
		object.timer++
		if object.timer == 47
			object.timer = 0
			object.state++
		end if	
	break
	case 3

	break
	end switch

end event


event ObjectDraw
	//Not Dead
	DrawRect(0, 0, screen.xsize, screen.ysize, 0x00, 0x00, 0x00, 128)


	temp0 = object.extraoffset	
	temp0 -= object.extratarget
	Abs(temp0)
	if temp0 < ST.xspeed // if object.extraoffset is less then ST.xspeed/15
		object.extraoffset = object.extratarget 	// offset = target
	else	// if its not
		if object.extraoffset < object.extratarget // if offset is less then target
			object.extraoffset += ST.xspeed	//go left
		end if
		if object.extraoffset > object.extratarget // if offset is greater then target
			object.extraoffset -= ST.xspeed	//go right
		end if
	end if
	switch object.state
		case 2
			object.extratarget = screen.xsize
			object.extratarget += 20

			temp3 = screen.xcenter	
			temp3 = 426
			temp3 -= object.extraoffset
			DrawSpriteScreenFX(0, FX_ROTATE, temp3, screen.ycenter)	

			DrawSpriteScreenFX(1, FX_ROTATE, temp3, screen.ycenter)	

		break
		case 3
			DrawSpriteScreenFX(0, FX_ROTATE, temp3, screen.ycenter)	

			DrawSpriteScreenFX(1, FX_ROTATE, temp3, screen.ycenter)	
			object.extratarget = 0
			break
	end switch

	//Techinal Stuff

	TileLayer[0].Angle = -32


	// Just take Sonic's Y Position, smooth it out a bit, and offset it by 88 pixels
	TileLayer[0].YPos = object.YPos
	TileLayer[0].YPos /= 3
	TileLayer[0].YPos += 0x1280000


end event


event ObjectStartup
	
	LoadSpriteSheet("3D_Test/Objects2.gif")
	
	//logo
	SpriteFrame(16, -96, 184, 57, 327, 1)	//0

	SpriteFrame(128, 0, 67, 45, 376, 59)		//1
	
	SetMusicTrack("RobloxHorror.ogg", 0, false)

	// Place the HUD object into reserved object slot 4 and initialise its values
	Object[4].Type = TypeName[Main Menu]
	
	// The object should always be run, regardless if it's within camera bounds or not
	Object[4].Priority = PRIORITY_ACTIVE
	
	// Make the HUD draw ontop of all other sprites, too
	Object[4].DrawOrder = 6
	
	

end event


// ========================
// Editor events
// ========================

event RSDKDraw
	DrawSprite(0)
end event


event RSDKLoad
	LoadSpriteSheet("3D_Test/Objects.gif")
	SpriteFrame(0, 0, 24, 16, 206, 58)

	SetVariableAlias(ALIAS_VAR_PROPVAL, "unused")
end event
